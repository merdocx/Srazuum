# –ß–µ–∫–ª–∏—Å—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–ª—è Production

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∏ –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º

### 1. –°–µ–∫—Ä–µ—Ç—ã –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- [x] –í—Å–µ —Å–µ–∫—Ä–µ—Ç—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ `.env` —Ñ–∞–π–ª–∞—Ö
- [x] `.env` —Ñ–∞–π–ª –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ `600` (—Ç–æ–ª—å–∫–æ –≤–ª–∞–¥–µ–ª–µ—Ü)
- [x] `.env` —Ñ–∞–π–ª –∏—Å–∫–ª—é—á–µ–Ω –∏–∑ git (–≤ `.gitignore`)
- [x] `.env.example` —Å–æ–¥–µ—Ä–∂–∏—Ç —à–∞–±–ª–æ–Ω—ã –±–µ–∑ —Ä–µ–∞–ª—å–Ω—ã—Ö —Å–µ–∫—Ä–µ—Ç–æ–≤
- [x] Systemd —Ñ–∞–π–ª—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç `EnvironmentFile=/path/to/.env` –≤–º–µ—Å—Ç–æ —Ö–∞—Ä–¥–∫–æ–¥–∞ —Å–µ–∫—Ä–µ—Ç–æ–≤
- [x] –ò—Å—Ç–æ—Ä–∏—è Git –æ—á–∏—â–µ–Ω–∞ –æ—Ç —Å–µ–∫—Ä–µ—Ç–æ–≤

### 2. –§–∞–π–ª—ã –∏ —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏
- [x] –†–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏ –ë–î (`*.sql`, `*.sql.gz`) –∏—Å–∫–ª—é—á–µ–Ω—ã –∏–∑ git
- [x] `session_string.txt` –∏ –µ–≥–æ —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏ –∏—Å–∫–ª—é—á–µ–Ω—ã –∏–∑ git
- [x] –†–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –∑–∞—â–∏—â–µ–Ω–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –≤–Ω–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
- [x] –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `backups/` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ (`700`)

### 3. Systemd —Å–µ—Ä–≤–∏—Å—ã
- [x] `PrivateTmp=true` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –¥–ª—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
- [x] `NoNewPrivileges=true` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –¥–ª—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
- [x] –°–µ—Ä–≤–∏—Å—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏–∑ `.env` —Ñ–∞–π–ª–∞
- [ ] –°–µ—Ä–≤–∏—Å—ã —Ä–∞–±–æ—Ç–∞—é—Ç –æ—Ç –Ω–µ-root –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, —Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏)

### 4. –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- [x] –ü–∞—Ä–æ–ª–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ —Ö–µ—à–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ `bcrypt`
- [x] JWT —Ç–æ–∫–µ–Ω—ã –∏–º–µ—é—Ç —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è (30 –º–∏–Ω—É—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- [x] `SECRET_KEY` –¥–ª—è JWT –∏–º–µ–µ—Ç –¥–ª–∏–Ω—É –Ω–µ –º–µ–Ω–µ–µ 32 —Å–∏–º–≤–æ–ª–æ–≤
- [x] Rate limiting –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è auth endpoints (5/15 –º–∏–Ω—É—Ç)
- [x] CORS –Ω–∞—Å—Ç—Ä–æ–µ–Ω —Å —è–≤–Ω—ã–º —É–∫–∞–∑–∞–Ω–∏–µ–º —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤

### 5. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- [x] –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è SQLAlchemy ORM (–∑–∞—â–∏—Ç–∞ –æ—Ç SQL-–∏–Ω—ä–µ–∫—Ü–∏–π)
- [x] –ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π —Å –ë–î
- [x] –ü–∞—Ä–æ–ª—å –ë–î —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ `.env`, –∞ –Ω–µ –≤ –∫–æ–¥–µ
- [ ] –†–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏ –ë–î —à–∏—Ñ—Ä—É—é—Ç—Å—è (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

### 6. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- [x] –°–µ–∫—Ä–µ—Ç—ã –Ω–µ –ø–æ–ø–∞–¥–∞—é—Ç –≤ –ª–æ–≥–∏
- [x] –¢–æ–∫–µ–Ω—ã –æ–±—Ä–µ–∑–∞—é—Ç—Å—è –≤ –ª–æ–≥–∞—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, `token[:10] + "..."`)
- [x] –õ–æ–≥–∏ –Ω–µ —Å–æ–¥–µ—Ä–∂–∞—Ç –ø–∞—Ä–æ–ª–µ–π
- [x] –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω

### 7. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- [x] –°–∫—Ä–∏–ø—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Å–æ–∑–¥–∞–Ω (`scripts/security_monitor.py`)
- [x] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω (systemd timer, –∫–∞–∂–¥—ã–µ 6 —á–∞—Å–æ–≤)
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã –∞–ª–µ—Ä—Ç—ã –Ω–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

### 8. –°–µ—Ç—å –∏ HTTPS
- [ ] HTTPS –Ω–∞—Å—Ç—Ä–æ–µ–Ω –≤ production (–Ω–µ HTTP)
- [ ] SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ (Let's Encrypt)
- [ ] Redirect —Å HTTP –Ω–∞ HTTPS –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [ ] Firewall –Ω–∞—Å—Ç—Ä–æ–µ–Ω (—Ç–æ–ª—å–∫–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–æ—Ä—Ç—ã –æ—Ç–∫—Ä—ã—Ç—ã)

### 9. –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- [ ] –†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (`pip list --outdated`)
- [ ] –ü—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è —É—è–∑–≤–∏–º–æ—Å—Ç–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è—Ö (`safety` –∏–ª–∏ `pip-audit`)
- [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ —á–µ—Ä–µ–∑ CI/CD –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã

### 10. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ä—ã
- [ ] 2FA –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
- [ ] IP whitelist –¥–ª—è admin –ø–∞–Ω–µ–ª–∏ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
- [ ] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ –≤—Ö–æ–¥–∞ —Å IP –∞–¥—Ä–µ—Å–∞–º–∏
- [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ IP –ø—Ä–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–∫–∞—Ö

---

## üîê –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∞ .env —Ñ–∞–π–ª–∞
ls -la /root/crossposting_service/.env
# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: -rw------- (600)

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ backups
ls -ld /root/crossposting_service/backups
# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: drwx------ (700)

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞
chmod 600 /root/crossposting_service/.env
chmod 700 /root/crossposting_service/backups
```

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫
```bash
python3 /root/crossposting_service/scripts/security_monitor.py
```

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ (systemd timer)
```bash
# –°—Ç–∞—Ç—É—Å —Ç–∞–π–º–µ—Ä–∞
systemctl status crossposting-security-monitor.timer

# –ó–∞–ø—É—Å–∫ —Ç–∞–π–º–µ—Ä–∞
systemctl start crossposting-security-monitor.timer

# –í–∫–ª—é—á–µ–Ω–∏–µ –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞
systemctl enable crossposting-security-monitor.timer

# –õ–æ–≥–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
journalctl -u crossposting-security-monitor.service -f
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ –Ω–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
```bash
# –ù–µ—É–¥–∞—á–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ –≤—Ö–æ–¥–∞ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞
journalctl -u crossposting-admin.service --since "24 hours ago" | grep -i "401\|unauthorized"

# –í—Å–µ –æ—à–∏–±–∫–∏ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π —á–∞—Å
journalctl -u crossposting-admin.service --since "1 hour ago" | grep -i "error\|failed"
```

---

## üö® –†–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –∏–Ω—Ü–∏–¥–µ–Ω—Ç—ã

### –ü—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ —É—Ç–µ—á–∫–∏ —Å–µ–∫—Ä–µ—Ç–æ–≤:
1. –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–µ —Å–µ–∫—Ä–µ—Ç—ã
2. –û–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ `.env` —Ñ–∞–π–ª—ã
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏

### –ü—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ –∞—Ç–∞–∫–∏:
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –Ω–∞ –∏—Å—Ç–æ—á–Ω–∏–∫ –∞—Ç–∞–∫–∏ (IP –∞–¥—Ä–µ—Å)
2. –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å IP —á–µ—Ä–µ–∑ firewall –∏–ª–∏ fail2ban
3. –£–≤–µ–¥–æ–º–∏—Ç—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö

---

## üìÖ –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏

- **–ï–∂–µ–¥–Ω–µ–≤–Ω–æ:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (systemd timer)
- **–ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ:** –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ –Ω–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
- **–ï–∂–µ–º–µ—Å—è—á–Ω–æ:** –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π
- **–ï–∂–µ–∫–≤–∞—Ä—Ç–∞–ª—å–Ω–æ:** –†–æ—Ç–∞—Ü–∏—è `SECRET_KEY` –∏ –¥—Ä—É–≥–∏—Ö —Å–µ–∫—Ä–µ—Ç–æ–≤
- **–ü—Ä–∏ –∫–∞–∂–¥–æ–º –¥–µ–ø–ª–æ–µ:** –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö –ø—É–Ω–∫—Ç–æ–≤ —á–µ–∫–ª–∏—Å—Ç–∞

---

**–î–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:** 2026-01-17
