# –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ: –ü–µ—Ä–µ–Ω–æ—Å —Å—Ç–∞—Ä—ã—Ö –ø–æ—Å—Ç–æ–≤ –∏–∑ Telegram –≤ MAX

## 1. –û–±—â–µ–µ –æ–ø–∏—Å–∞–Ω–∏–µ

–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –ø–µ—Ä–µ–Ω–æ—Å–∞ –≤—Å–µ—Ö –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –ø–æ—Å—Ç–æ–≤ –∏–∑ Telegram-–∫–∞–Ω–∞–ª–∞ –≤ MAX-–∫–∞–Ω–∞–ª –¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Å–≤—è–∑–∏ –∫—Ä–æ—Å—Å–ø–æ—Å—Ç–∏–Ω–≥–∞.

## 2. –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—É

### 2.1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

#### 2.1.1. –ö–Ω–æ–ø–∫–∞ –≤ –≥–ª–∞–≤–Ω–æ–º –º–µ–Ω—é
- –î–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É "üì• –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ —Å—Ç–∞—Ä—ã–µ –ø–æ—Å—Ç—ã" –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é –±–æ—Ç–∞ (ReplyKeyboardMarkup)
- –ö–Ω–æ–ø–∫–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–Ω–∞ –≤—Å–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º

#### 2.1.2. –í—ã–±–æ—Ä —Å–≤—è–∑–∏ –¥–ª—è –ø–µ—Ä–µ–Ω–æ—Å–∞
- –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ –∫–Ω–æ–ø–∫—É –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–≤—è–∑–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –°–ø–∏—Å–æ–∫ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ: `‚úÖ –°–≤—è–∑—å #ID` –∏–ª–∏ `‚ùå –°–≤—è–∑—å #ID` (–≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å—Ç–∞—Ç—É—Å–∞)
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç —Å–≤—è–∑—å –¥–ª—è –ø–µ—Ä–µ–Ω–æ—Å–∞, –Ω–∞–∂–∞–≤ –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é –∫–Ω–æ–ø–∫—É

#### 2.1.3. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –Ω–∞—á–∞–ª–µ –ø–µ—Ä–µ–Ω–æ—Å–∞
–ü–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞ —Å–≤—è–∑–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ:
```
‚ö†Ô∏è –ù–∞—á–∏–Ω–∞–µ—Ç—Å—è –ø–µ—Ä–µ–Ω–æ—Å —Å—Ç–∞—Ä—ã—Ö –ø–æ—Å—Ç–æ–≤ –¥–ª—è —Å–≤—è–∑–∏ #ID

Telegram: [–Ω–∞–∑–≤–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–∞]
MAX: [–Ω–∞–∑–≤–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–∞]

üìã –í–∞–∂–Ω–æ:
‚Ä¢ –ü–æ—Å—Ç–∞—Ä–∞–π—Ç–µ—Å—å –Ω–µ –ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –Ω–æ–≤—ã–µ –ø–æ—Å—Ç—ã –≤ Telegram –∫–∞–Ω–∞–ª–µ –¥–æ –æ–∫–æ–Ω—á–∞–Ω–∏—è –ø–µ—Ä–µ–Ω–æ—Å–∞
‚Ä¢ –í—ã –ø–æ–ª—É—á–∏—Ç–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø–æ –æ–∫–æ–Ω—á–∞–Ω–∏–∏ –ø–µ—Ä–µ–Ω–æ—Å–∞

‚è≥ –ù–∞—á–∏–Ω–∞—é –ø–µ—Ä–µ–Ω–æ—Å (–≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ—Å—Ç–æ–≤ –ø–µ—Ä–µ–Ω–æ—Å –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –æ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–∏–Ω—É—Ç –¥–æ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —á–∞—Å–æ–≤)...
```

#### 2.1.4. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± –æ–∫–æ–Ω—á–∞–Ω–∏–∏ –ø–µ—Ä–µ–Ω–æ—Å–∞
–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø–µ—Ä–µ–Ω–æ—Å–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ —Å–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π:
```
‚úÖ –ü–µ—Ä–µ–Ω–æ—Å —Å—Ç–∞—Ä—ã—Ö –ø–æ—Å—Ç–æ–≤ –∑–∞–≤–µ—Ä—à–µ–Ω –¥–ª—è —Å–≤—è–∑–∏ #ID

üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:
‚Ä¢ –í—Å–µ–≥–æ –ø–æ—Å—Ç–æ–≤: [N]
‚Ä¢ –£—Å–ø–µ—à–Ω–æ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–æ: [M]
‚Ä¢ –ü—Ä–æ–ø—É—â–µ–Ω–æ (—É–∂–µ –±—ã–ª–∏): [K]
‚Ä¢ –ù–µ —É–¥–∞–ª–æ—Å—å –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏: [L]

‚è± –í—Ä–µ–º—è –ø–µ—Ä–µ–Ω–æ—Å–∞: [–≤—Ä–µ–º—è]
```

### 2.2. –õ–æ–≥–∏–∫–∞ –ø–µ—Ä–µ–Ω–æ—Å–∞

#### 2.2.1. –ü–æ–ª—É—á–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –ø–æ—Å—Ç–æ–≤
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Pyrogram –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –∏–∑ Telegram-–∫–∞–Ω–∞–ª–∞
- –ü–æ–ª—É—á–∞—Ç—å –ø–æ—Å—Ç—ã –≤ –ø–æ—Ä—è–¥–∫–µ –æ—Ç —Å—Ç–∞—Ä—ã—Ö –∫ –Ω–æ–≤—ã–º (–æ—Ç –ø–µ—Ä–≤–æ–≥–æ –ø–æ—Å—Ç–∞ –∫ –ø–æ—Å–ª–µ–¥–Ω–µ–º—É)
- **–í–ê–ñ–ù–û: –ü–æ—Ç–æ–∫–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ (Streaming)**
  - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `async for` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏ –ø–æ—Ç–æ–∫–æ–º
  - –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –ø–æ—Å—Ç—ã –ø–æ –º–µ—Ä–µ –ø–æ–ª—É—á–µ–Ω–∏—è, –Ω–µ –∑–∞–≥—Ä—É–∂–∞—Ç—å –≤—Å—é –∏—Å—Ç–æ—Ä–∏—é –≤ –ø–∞–º—è—Ç—å
  - –≠—Ç–æ –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è –±–æ–ª—å—à–∏—Ö –∫–∞–Ω–∞–ª–æ–≤ (—Ç—ã—Å—è—á–∏ –ø–æ—Å—Ç–æ–≤)
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `get_chat_history()` —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏:
  - `limit=None` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –≤—Å–µ—Ö –ø–æ—Å—Ç–æ–≤
  - –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ –ø—Ä–∏ –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –ø–æ—Å—Ç–æ–≤
- **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è**: –î–ª—è –æ—á–µ–Ω—å –±–æ–ª—å—à–∏—Ö –∫–∞–Ω–∞–ª–æ–≤ –º–æ–∂–Ω–æ —Ä–∞–∑–¥–µ–ª–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é –Ω–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–µ—Ä–∏–æ–¥—ã –∏ –ø–æ–ª—É—á–∞—Ç—å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ

#### 2.2.2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ
- **–ö–†–ò–¢–ò–ß–ù–û: –ë–∞—Ç—á–∏–Ω–≥ –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è**
  - –ù–ï –ø—Ä–æ–≤–µ—Ä—è—Ç—å –∫–∞–∂–¥—ã–π –ø–æ—Å—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–º –∑–∞–ø—Ä–æ—Å–æ–º –∫ –ë–î
  - –ó–∞–≥—Ä—É–∑–∏—Ç—å –≤—Å–µ —É–∂–µ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–Ω—ã–µ –ø–æ—Å—Ç—ã –æ–¥–Ω–∏–º –∑–∞–ø—Ä–æ—Å–æ–º –≤ –ø–∞–º—è—Ç—å (set)
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –ø–∞–º—è—Ç–∏: O(1) –≤–º–µ—Å—Ç–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –ë–î
  - –≠—Ç–æ —Å–æ–∫—Ä–∞—â–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ —Å N –¥–æ 1 –¥–ª—è –≤—Å–µ–≥–æ –∫–∞–Ω–∞–ª–∞
- **–ö–†–ò–¢–ò–ß–ù–û: –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –ø–∞–º—è—Ç–∏**
  - –ó–∞–≥—Ä—É–∑–∏—Ç—å –≤—Å–µ `telegram_message_id` –¥–ª—è —Å–≤—è–∑–∏ –≤ set –æ–¥–∏–Ω —Ä–∞–∑
  - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `existing_ids = set()` –¥–ª—è O(1) –ø—Ä–æ–≤–µ—Ä–∫–∏
  - –û–±–Ω–æ–≤–ª—è—Ç—å set –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–º –ø–µ—Ä–µ–Ω–æ—Å–µ –Ω–æ–≤—ã—Ö –ø–æ—Å—Ç–æ–≤
- –ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏:
  - `telegram_channel_id` —Å–æ–≤–ø–∞–¥–∞–µ—Ç
  - `telegram_message_id` —Å–æ–≤–ø–∞–¥–∞–µ—Ç
  - `crossposting_link_id` —Å–æ–≤–ø–∞–¥–∞–µ—Ç
  - `status == 'success'`
- –ï—Å–ª–∏ –ø–æ—Å—Ç —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ –∫—ç—à–µ - –ø—Ä–æ–ø—É—Å–∫–∞—Ç—å –µ–≥–æ
- –î–ª—è –º–µ–¥–∏–∞-–≥—Ä—É–ø–ø: –µ—Å–ª–∏ —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–∑ –≥—Ä—É–ø–ø—ã —É–∂–µ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–æ - –ø—Ä–æ–ø—É—Å–∫–∞—Ç—å –≤—Å—é –≥—Ä—É–ø–ø—É
- **–í–ê–ñ–ù–û: –ò–Ω–¥–µ–∫—Å—ã –ë–î**
  - –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –µ—Å—Ç—å —Å–æ—Å—Ç–∞–≤–Ω–æ–π –∏–Ω–¥–µ–∫—Å –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏:
    ```sql
    CREATE INDEX IF NOT EXISTS idx_message_log_migration_check 
    ON message_log(crossposting_link_id, telegram_message_id, status)
    WHERE status = 'success';
    ```

#### 2.2.3. –û–±—Ä–∞–±–æ—Ç–∫–∞ –º–µ–¥–∏–∞-–≥—Ä—É–ø–ø
- –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ `media_group_id`
- **–í–ê–ñ–ù–û: –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞**
  - –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –º–µ–¥–∏–∞-–≥—Ä—É–ø–ø—ã –î–û –Ω–∞—á–∞–ª–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–æ—Å—Ç–æ–≤
  - –°–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≥—Ä—É–ø–ø—ã –ø–æ –¥–∞—Ç–µ –ø–µ—Ä–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è (–æ—Ç —Å—Ç–∞—Ä—ã—Ö –∫ –Ω–æ–≤—ã–º)
  - –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –≥—Ä—É–ø–ø—ã –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, –Ω–æ –º–µ–¥–∏–∞—Ñ–∞–π–ª—ã –≤–Ω—É—Ç—Ä–∏ –≥—Ä—É–ø–ø—ã –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –º–µ–¥–∏–∞-–≥—Ä—É–ø–ø—ã –∫–∞–∫ –µ–¥–∏–Ω–æ–µ —Ü–µ–ª–æ–µ
- **–í–ê–ñ–ù–û**: –ù–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–µ–¥–∏–∞—Ñ–∞–π–ª–æ–≤ –≤ –≥—Ä—É–ø–ø–µ - –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –í–°–ï —Ñ–∞–π–ª—ã
- **–í–ê–ñ–ù–û: –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –º–µ–¥–∏–∞**
  - –ó–∞–≥—Ä—É–∂–∞—Ç—å –≤—Å–µ –º–µ–¥–∏–∞—Ñ–∞–π–ª—ã –∏–∑ –≥—Ä—É–ø–ø—ã –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º `asyncio.gather()`
  - –≠—Ç–æ —É—Å–∫–æ—Ä—è–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É –º–µ–¥–∏–∞-–≥—Ä—É–ø–ø —Å –±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —Ñ–∞–π–ª–æ–≤
- –ü–æ—Ä—è–¥–æ–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –º–µ–¥–∏–∞-–≥—Ä—É–ø–ø: –æ—Ç —Å—Ç–∞—Ä—ã—Ö –∫ –Ω–æ–≤—ã–º (–ø–æ –¥–∞—Ç–µ –ø–µ—Ä–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –≥—Ä—É–ø–ø–µ)

#### 2.2.4. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –ø–æ—Å—Ç–æ–≤
- –¢–µ–∫—Å—Ç–æ–≤—ã–µ –ø–æ—Å—Ç—ã –±–µ–∑ –º–µ–¥–∏–∞
- –ü–æ—Å—Ç—ã —Å –æ–¥–Ω–∏–º —Ñ–æ—Ç–æ
- –ü–æ—Å—Ç—ã —Å –æ–¥–Ω–∏–º –≤–∏–¥–µ–æ
- –ü–æ—Å—Ç—ã —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏ (–µ—Å–ª–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è)
- **–í–ê–ñ–ù–û: –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞**
  - –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ—Å—Ç–æ–≤ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º `asyncio.Semaphore`
  - –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤: 5
  - –≠—Ç–æ —É—Å–∫–æ—Ä—è–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É –≤ 3-5 —Ä–∞–∑ –ø—Ä–∏ —Å–æ–±–ª—é–¥–µ–Ω–∏–∏ rate limits
  - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `asyncio.gather()` –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –±–∞—Ç—á–µ–π –ø–æ—Å—Ç–æ–≤

#### 2.2.5. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- –ï—Å–ª–∏ –ø–µ—Ä–µ–Ω–æ—Å –ø–æ—Å—Ç–∞ –Ω–µ —É–¥–∞–ª—Å—è:
  - –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –æ—à–∏–±–∫—É
  - –£–≤–µ–ª–∏—á–∏—Ç—å —Å—á–µ—Ç—á–∏–∫ –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫
  - **–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å –ø–æ—Å—Ç –∏ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –ø–µ—Ä–µ–Ω–æ—Å** (–Ω–µ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å)
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫ –¥–ª—è –æ–¥–Ω–æ–≥–æ –ø–æ—Å—Ç–∞: **1 –ø–æ–ø—ã—Ç–∫–∞** (–±–µ–∑ —Ä–µ—Ç—Ä–∞–µ–≤)
- –ï—Å–ª–∏ –ø–æ–ø—ã—Ç–∫–∞ –Ω–µ —É–¥–∞–ª–∞—Å—å - –ø–æ—Å—Ç –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è, –ø–µ—Ä–µ–Ω–æ—Å –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è

#### 2.2.6. –£—á–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π API
- –°–æ–±–ª—é–¥–∞—Ç—å rate limits MAX API:
  - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `max_api_limiter` –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è —á–∞—Å—Ç–æ—Ç—ã –∑–∞–ø—Ä–æ—Å–æ–≤
  - –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –∑–∞–¥–µ—Ä–∂–∫–∏ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏
- –°–æ–±–ª—é–¥–∞—Ç—å rate limits Telegram API:
  - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `telegram_api_limiter` –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –∏—Å—Ç–æ—Ä–∏–∏
  - –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ —á–∞—Å—Ç–æ—Ç—É –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ Telegram

#### 2.2.7. –û—á–µ—Ä–µ–¥—å –Ω–æ–≤—ã—Ö –ø–æ—Å—Ç–æ–≤
- –í–æ –≤—Ä–µ–º—è –ø–µ—Ä–µ–Ω–æ—Å–∞ –Ω–æ–≤—ã–µ –ø–æ—Å—Ç—ã –∏–∑ Telegram –¥–æ–ª–∂–Ω—ã —Å—Ç–∞–≤–∏—Ç—å—Å—è –≤ –æ—á–µ—Ä–µ–¥—å
- –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø–µ—Ä–µ–Ω–æ—Å–∞ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –≤—Å–µ –ø–æ—Å—Ç—ã –∏–∑ –æ—á–µ—Ä–µ–¥–∏
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–µ—Ö–∞–Ω–∏–∑–º `MigrationQueue` –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ—á–µ—Ä–µ–¥—å—é

### 2.3. –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

#### 2.3.1. –°–±–æ—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
–û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –º–µ—Ç—Ä–∏–∫–∏:
- `total`: –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Å—Ç–æ–≤ –≤ –∫–∞–Ω–∞–ª–µ
- `success`: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—Å–ø–µ—à–Ω–æ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–Ω—ã—Ö –ø–æ—Å—Ç–æ–≤
- `skipped`: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –ø–æ—Å—Ç–æ–≤ (—É–∂–µ –±—ã–ª–∏ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω—ã)
- `failed`: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Å—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ —É–¥–∞–ª–æ—Å—å –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏
- `start_time`: –í—Ä–µ–º—è –Ω–∞—á–∞–ª–∞ –ø–µ—Ä–µ–Ω–æ—Å–∞
- `end_time`: –í—Ä–µ–º—è –æ–∫–æ–Ω—á–∞–Ω–∏—è –ø–µ—Ä–µ–Ω–æ—Å–∞
- `duration`: –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–Ω–æ—Å–∞

#### 2.3.2. –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ —Ñ–∏–Ω–∞–ª—å–Ω–æ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–∏
- –ï—Å–ª–∏ –ø–æ—Å—Ç–æ–≤ –≤ –∫–∞–Ω–∞–ª–µ –Ω–µ –±—ã–ª–æ (`total == 0`), –≤—Å–µ —Ä–∞–≤–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π `0/0/0/0`

### 2.4. –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

#### 2.4.1. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- –°–æ–∑–¥–∞—Ç—å –º–æ–¥—É–ª—å `app/core/post_migrator.py` –¥–ª—è –ª–æ–≥–∏–∫–∏ –ø–µ—Ä–µ–Ω–æ—Å–∞
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π `MessageProcessor` –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–æ—Å—Ç–æ–≤ –≤ MAX
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π `MigrationQueue` –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ—á–µ—Ä–µ–¥—å—é
- –°–æ–∑–¥–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–π Pyrogram –∫–ª–∏–µ–Ω—Ç –¥–ª—è –ø–µ—Ä–µ–Ω–æ—Å–∞ (–Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–ª–∏–µ–Ω—Ç –∏–∑ MTProto Receiver)

#### 2.4.2. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å FSM –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–µ—Ä–µ–Ω–æ—Å–∞
- –°–æ—Å—Ç–æ—è–Ω–∏—è:
  - `MigrateStates.selecting_link`: –í—ã–±–æ—Ä —Å–≤—è–∑–∏ –¥–ª—è –ø–µ—Ä–µ–Ω–æ—Å–∞
  - `MigrateStates.migrating`: –ü—Ä–æ—Ü–µ—Å—Å –ø–µ—Ä–µ–Ω–æ—Å–∞ –∞–∫—Ç–∏–≤–µ–Ω

#### 2.4.3. –û–±—Ä–∞–±–æ—Ç–∫–∞ –º–µ–¥–∏–∞—Ñ–∞–π–ª–æ–≤
- **–í–ê–ñ–ù–û**: –ù–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–µ–¥–∏–∞—Ñ–∞–π–ª–æ–≤ –≤ –æ–¥–Ω–æ–º –ø–æ—Å—Ç–µ
- –í—Å–µ –º–µ–¥–∏–∞—Ñ–∞–π–ª—ã –∏–∑ –º–µ–¥–∏–∞-–≥—Ä—É–ø–ø—ã –¥–æ–ª–∂–Ω—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å—Å—è –∏ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å—Å—è
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –º–µ—Ç–æ–¥—ã `_process_media_group` –∏ `_send_media_group`
- –û–±–µ—Å–ø–µ—á–∏—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É —Å–º–µ—à–∞–Ω–Ω—ã—Ö –º–µ–¥–∏–∞-–≥—Ä—É–ø–ø (—Ñ–æ—Ç–æ + –≤–∏–¥–µ–æ)

#### 2.4.4. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–∞–±–ª–∏—Ü—ã:
  - `message_log` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è
  - `crossposting_link` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å–≤—è–∑–∏
  - `telegram_channel` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∫–∞–Ω–∞–ª–µ
- **–ö–†–ò–¢–ò–ß–ù–û: –ë–∞—Ç—á–∏–Ω–≥ –≤—Å—Ç–∞–≤–æ–∫ –≤ message_log**
  - –ù–ï —Å–æ–∑–¥–∞–≤–∞—Ç—å –∑–∞–ø–∏—Å—å –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ—Å—Ç–∞ –æ—Ç–¥–µ–ª—å–Ω—ã–º –∑–∞–ø—Ä–æ—Å–æ–º
  - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–∞—Ç—á–∏–Ω–≥: —Å–æ–∑–¥–∞–≤–∞—Ç—å –∑–∞–ø–∏—Å–∏ –±–∞—Ç—á–∞–º–∏ –ø–æ 100 —à—Ç—É–∫
  - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `session.add_all()` –¥–ª—è –±–∞—Ç—á–∞ –∑–∞–ø–∏—Å–µ–π
  - –≠—Ç–æ —Å–æ–∫—Ä–∞—â–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –ë–î –≤ 100 —Ä–∞–∑
- –ü—Ä–∏ —É—Å–ø–µ—à–Ω–æ–º –ø–µ—Ä–µ–Ω–æ—Å–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å –∑–∞–ø–∏—Å–∏ –≤ `message_log` –¥–ª—è –≤—Å–µ—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –º–µ–¥–∏–∞-–≥—Ä—É–ø–ø—ã
- **–í–ê–ñ–ù–û: Eager loading**
  - –ó–∞–≥—Ä—É–∂–∞—Ç—å —Å–≤—è–∑–∏ —Å `selectinload()` –æ–¥–∏–Ω —Ä–∞–∑, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–æ
  - –ò–∑–±–µ–≥–∞—Ç—å N+1 –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –ë–î

#### 2.4.5. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ —ç—Ç–∞–ø—ã –ø–µ—Ä–µ–Ω–æ—Å–∞:
  - –ù–∞—á–∞–ª–æ –ø–µ—Ä–µ–Ω–æ—Å–∞ –¥–ª—è —Å–≤—è–∑–∏
  - –ü—Ä–æ–≥—Ä–µ—Å—Å –ø–µ—Ä–µ–Ω–æ—Å–∞ (–∫–∞–∂–¥—ã–µ N –ø–æ—Å—Ç–æ–≤ –∏–ª–∏ –∫–∞–∂–¥—ã–µ X –º–∏–Ω—É—Ç)
  - –û—à–∏–±–∫–∏ –ø—Ä–∏ –ø–µ—Ä–µ–Ω–æ—Å–µ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –ø–æ—Å—Ç–æ–≤
  - –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –ø–µ—Ä–µ–Ω–æ—Å–∞ —Å–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π
- **–í–ê–ñ–ù–û: –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞**
  - –û—Ç–ø—Ä–∞–≤–ª—è—Ç—å –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é:
    - –ö–∞–∂–¥—ã–µ 100 –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –ø–æ—Å—Ç–æ–≤
    - –ö–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç (–µ—Å–ª–∏ –ø—Ä–æ—à–ª–æ 5 –º–∏–Ω—É—Ç —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è)
  - –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö/–≤—Å–µ–≥–æ, –ø—Ä–æ—Ü–µ–Ω—Ç, –ø—Ä–∏–º–µ—Ä–Ω–æ–µ –≤—Ä–µ–º—è –¥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
  - –≠—Ç–æ —É–ª—É—á—à–∞–µ—Ç UX –¥–ª—è –¥–ª–∏—Ç–µ–ª—å–Ω—ã—Ö –º–∏–≥—Ä–∞—Ü–∏–π

### 2.5. –û–±—Ä–∞–±–æ—Ç–∫–∞ –≥—Ä–∞–Ω–∏—á–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤

#### 2.5.1. –ü—É—Å—Ç–æ–π –∫–∞–Ω–∞–ª
- –ï—Å–ª–∏ –≤ –∫–∞–Ω–∞–ª–µ –Ω–µ—Ç –ø–æ—Å—Ç–æ–≤ - –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π `0/0/0/0`

#### 2.5.2. –í—Å–µ –ø–æ—Å—Ç—ã —É–∂–µ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω—ã
- –ï—Å–ª–∏ –≤—Å–µ –ø–æ—Å—Ç—ã —É–∂–µ –µ—Å—Ç—å –≤ –ª–æ–≥–∞—Ö - –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ: `–í—Å–µ –ø–æ—Å—Ç—ã —É–∂–µ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω—ã (N/N/0/0)`

#### 2.5.3. –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –∏—Å—Ç–æ—Ä–∏–∏
- –ï—Å–ª–∏ –Ω–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é –∫–∞–Ω–∞–ª–∞ - –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
- –ù–µ –Ω–∞—á–∏–Ω–∞—Ç—å –ø–µ—Ä–µ–Ω–æ—Å, –µ—Å–ª–∏ –∏—Å—Ç–æ—Ä–∏—è –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞

#### 2.5.4. –ü—Ä–µ—Ä—ã–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–Ω–æ—Å–∞
- –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–µ—Ä–≤–∞–ª –ø—Ä–æ—Ü–µ—Å—Å (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏–ª –±–æ—Ç–∞) - –ø–µ—Ä–µ–Ω–æ—Å –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è
- –ü—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º –∑–∞–ø—É—Å–∫–µ –ø–µ—Ä–µ–Ω–æ—Å –Ω–∞—á–Ω–µ—Ç—Å—è –∑–∞–Ω–æ–≤–æ (—É–∂–µ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–Ω—ã–µ –ø–æ—Å—Ç—ã –±—É–¥—É—Ç –ø—Ä–æ–ø—É—â–µ–Ω—ã)

### 2.6. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

#### 2.6.1. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è (–ö–†–ò–¢–ò–ß–ù–´–ï)
- **–ë–∞—Ç—á–∏–Ω–≥ –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è**: –ó–∞–≥—Ä—É–∑–∏—Ç—å –≤—Å–µ —É–∂–µ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–Ω—ã–µ –ø–æ—Å—Ç—ã –æ–¥–Ω–∏–º –∑–∞–ø—Ä–æ—Å–æ–º –≤ –ø–∞–º—è—Ç—å
- **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –ø–∞–º—è—Ç–∏**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å set –¥–ª—è O(1) –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è
- **–ë–∞—Ç—á–∏–Ω–≥ –≤—Å—Ç–∞–≤–æ–∫ –≤ –ë–î**: –°–æ–∑–¥–∞–≤–∞—Ç—å –∑–∞–ø–∏—Å–∏ –≤ message_log –±–∞—Ç—á–∞–º–∏ –ø–æ 100 —à—Ç—É–∫
- **–ò–Ω–¥–µ–∫—Å—ã –ë–î**: –°–æ—Å—Ç–∞–≤–Ω–æ–π –∏–Ω–¥–µ–∫—Å –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è
- **–ü–æ—Ç–æ–∫–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞**: –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –ø–æ—Å—Ç—ã –ø–æ –º–µ—Ä–µ –ø–æ–ª—É—á–µ–Ω–∏—è, –Ω–µ –∑–∞–≥—Ä—É–∂–∞—Ç—å –≤—Å—é –∏—Å—Ç–æ—Ä–∏—é –≤ –ø–∞–º—è—Ç—å

#### 2.6.2. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è (–í–ê–ñ–ù–´–ï)
- **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ—Å—Ç–æ–≤**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `asyncio.Semaphore(5)` –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º–∞
- **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –º–µ–¥–∏–∞**: –ó–∞–≥—Ä—É–∂–∞—Ç—å –≤—Å–µ –º–µ–¥–∏–∞—Ñ–∞–π–ª—ã –∏–∑ –≥—Ä—É–ø–ø—ã –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
- **Eager loading**: –ó–∞–≥—Ä—É–∂–∞—Ç—å —Å–≤—è–∑–∏ —Å `selectinload()` –æ–¥–∏–Ω —Ä–∞–∑
- **–ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞**: –û—Ç–ø—Ä–∞–≤–ª—è—Ç—å –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

#### 2.6.3. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è (–ñ–ï–õ–ê–¢–ï–õ–¨–ù–´–ï)
- **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞**: –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ—Å–ª–µ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è
- **–î–µ—Ç–∞–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏**: –°–±–æ—Ä –º–µ—Ç—Ä–∏–∫ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
- **Graceful shutdown**: –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–∏–≥–Ω–∞–ª–æ–≤ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è

#### 2.6.4. –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
- –°–æ–±–ª—é–¥–∞—Ç—å rate limits API (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å rate limiter)
- –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –∑–∞–¥–µ—Ä–∂–∫–∏ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –±–æ–ª—å—à–∏—Ö –∫–∞–Ω–∞–ª–æ–≤ (—Ç—ã—Å—è—á–∏ –ø–æ—Å—Ç–æ–≤) –¥–æ–ª–∂–Ω–∞ —Ä–∞–±–æ—Ç–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å semaphore –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º–∞ –∏ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∏ API

#### 2.6.5. –û—Ü–µ–Ω–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- **–ë–µ–∑ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π**: –ö–∞–Ω–∞–ª —Å 10,000 –ø–æ—Å—Ç–æ–≤ - ~5-10 —á–∞—Å–æ–≤, 10,000 –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –ë–î
- **–° –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è–º–∏**: –ö–∞–Ω–∞–ª —Å 10,000 –ø–æ—Å—Ç–æ–≤ - ~1-2 —á–∞—Å–∞, 10 –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –ë–î
- **–£—Å–∫–æ—Ä–µ–Ω–∏–µ**: 3-5x –¥–ª—è —Ç–∏–ø–∏—á–Ω—ã—Ö –∫–∞–Ω–∞–ª–æ–≤, –¥–æ 10x –¥–ª—è –±–æ–ª—å—à–∏—Ö –∫–∞–Ω–∞–ª–æ–≤

## 3. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–æ–¥—É–ª–µ–π

### 3.1. `app/core/post_migrator.py`
```python
class PostMigrator:
    def __init__(self, pyrogram_client, message_processor):
        # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        self.semaphore = asyncio.Semaphore(5)  # –ü–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º: 5 –ø–æ—Å—Ç–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
        
    async def migrate_link_posts(self, link_id, progress_callback):
        # –û—Å–Ω–æ–≤–Ω–æ–π –º–µ—Ç–æ–¥ –ø–µ—Ä–µ–Ω–æ—Å–∞ —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è–º–∏
        
    async def _get_chat_history_stream(self, chat_id):
        # –ü–æ—Ç–æ–∫–æ–≤–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –ø–æ—Å—Ç–æ–≤ (async generator)
        # –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –ø–æ –º–µ—Ä–µ –ø–æ–ª—É—á–µ–Ω–∏—è, –Ω–µ –∑–∞–≥—Ä—É–∂–∞—Ç—å –≤—Å–µ –≤ –ø–∞–º—è—Ç—å
        
    async def _load_existing_messages_cache(self, link_id, session):
        # –ó–∞–≥—Ä—É–∑–∏—Ç—å –≤—Å–µ —É–∂–µ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–Ω—ã–µ –ø–æ—Å—Ç—ã –æ–¥–Ω–∏–º –∑–∞–ø—Ä–æ—Å–æ–º –≤ set
        # –ö–†–ò–¢–ò–ß–ù–û: O(1) –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤–º–µ—Å—Ç–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –ë–î
        
    async def _group_messages_by_media_group(self, messages):
        # –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –º–µ–¥–∏–∞-–≥—Ä—É–ø–ø
        # –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –¥–∞—Ç–µ –ø–µ—Ä–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
        
    async def _process_posts_parallel(self, posts, existing_ids, semaphore):
        # –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ—Å—Ç–æ–≤ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º —á–µ—Ä–µ–∑ semaphore
        
    async def _batch_create_message_logs(self, logs_data, session):
        # –ë–∞—Ç—á–∏–Ω–≥ –≤—Å—Ç–∞–≤–æ–∫ –≤ message_log (–ø–æ 100 –∑–∞–ø–∏—Å–µ–π)
        
    async def _convert_message(self, message):
        # –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è Pyrogram —Å–æ–æ–±—â–µ–Ω–∏—è –≤ —Ñ–æ—Ä–º–∞—Ç –¥–ª—è MessageProcessor
        
    async def _process_queued_messages(self, link_id):
        # –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ—Å—Ç–æ–≤ –∏–∑ –æ—á–µ—Ä–µ–¥–∏ –ø–æ—Å–ª–µ –ø–µ—Ä–µ–Ω–æ—Å–∞
        
    async def _send_progress_update(self, processed, total, start_time):
        # –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ (–∫–∞–∂–¥—ã–µ 100 –ø–æ—Å—Ç–æ–≤ –∏–ª–∏ 5 –º–∏–Ω—É—Ç)
```

### 3.2. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ `app/bot/handlers.py`
- –î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ "üì• –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ —Å—Ç–∞—Ä—ã–µ –ø–æ—Å—Ç—ã"
- –î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—ã–±–æ—Ä–∞ —Å–≤—è–∑–∏ –¥–ª—è –ø–µ—Ä–µ–Ω–æ—Å–∞
- –î–æ–±–∞–≤–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é `start_migration` –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –ø–µ—Ä–µ–Ω–æ—Å–∞
- –î–æ–±–∞–≤–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏—è FSM –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–∏

### 3.3. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ `app/bot/keyboards.py`
- –î–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É "üì• –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ —Å—Ç–∞—Ä—ã–µ –ø–æ—Å—Ç—ã" –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
- –î–æ–±–∞–≤–∏—Ç—å –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É –¥–ª—è –≤—ã–±–æ—Ä–∞ —Å–≤—è–∑–∏ (`get_migrate_links_keyboard`)

## 4. –ê–ª–≥–æ—Ä–∏—Ç–º –ø–µ—Ä–µ–Ω–æ—Å–∞ (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π)

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "üì• –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ —Å—Ç–∞—Ä—ã–µ –ø–æ—Å—Ç—ã"
2. –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —Å–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–≤—è–∑–µ–π
3. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç —Å–≤—è–∑—å
4. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –Ω–∞—á–∞–ª–µ –ø–µ—Ä–µ–Ω–æ—Å–∞
5. –°–æ–∑–¥–∞–µ—Ç—Å—è Pyrogram –∫–ª–∏–µ–Ω—Ç (–∏—Å–ø–æ–ª—å–∑—É—è `session_string.txt` –∏–ª–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Å–µ—Å—Å–∏—é)
6. **–û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø**: –ó–∞–≥—Ä—É–∑–∏—Ç—å –≤—Å–µ —É–∂–µ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–Ω—ã–µ –ø–æ—Å—Ç—ã –æ–¥–Ω–∏–º –∑–∞–ø—Ä–æ—Å–æ–º –≤ set (–∫—ç—à –≤ –ø–∞–º—è—Ç–∏)
7. **–û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø**: –°–æ–∑–¥–∞—Ç—å semaphore –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º–∞ (5 –ø–æ—Å—Ç–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ)
8. **–û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø**: –ü–æ—Ç–æ–∫–æ–≤–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –ø–æ—Å—Ç–æ–≤ (async for, –Ω–µ –∑–∞–≥—Ä—É–∂–∞—Ç—å –≤—Å–µ –≤ –ø–∞–º—è—Ç—å)
9. **–û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø**: –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –º–µ–¥–∏–∞-–≥—Ä—É–ø–ø –ø–æ `media_group_id`
10. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ—Å—Ç–∞/–≥—Ä—É–ø–ø—ã:
    - –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –∫—ç—à–µ (O(1) –≤ –ø–∞–º—è—Ç–∏)
    - –ï—Å–ª–∏ —É–∂–µ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω - –ø—Ä–æ–ø—É—Å–∫, —É–≤–µ–ª–∏—á–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–∞ `skipped`
    - –ï—Å–ª–∏ –Ω–µ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω:
      - **–û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø**: –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å semaphore (–¥–æ 5 –ø–æ—Å—Ç–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ)
      - –ü–æ–ø—ã—Ç–∫–∞ –ø–µ—Ä–µ–Ω–æ—Å–∞ —á–µ—Ä–µ–∑ `MessageProcessor`
      - **–û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø**: –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –º–µ–¥–∏–∞—Ñ–∞–π–ª–æ–≤ –¥–ª—è –º–µ–¥–∏–∞-–≥—Ä—É–ø–ø
      - –ü—Ä–∏ —É—Å–ø–µ—Ö–µ - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∫—ç—à, —É–≤–µ–ª–∏—á–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–∞ `success`
      - –ü—Ä–∏ –æ—à–∏–±–∫–µ - –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ, —É–≤–µ–ª–∏—á–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–∞ `failed`, –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ
11. **–û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø**: –ë–∞—Ç—á–∏–Ω–≥ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–µ–π –≤ `message_log` (–ø–æ 100 –∑–∞–ø–∏—Å–µ–π)
12. **–û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø**: –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ (–∫–∞–∂–¥—ã–µ 100 –ø–æ—Å—Ç–æ–≤ –∏–ª–∏ 5 –º–∏–Ω—É—Ç)
13. –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø–µ—Ä–µ–Ω–æ—Å–∞ - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ—Å—Ç–æ–≤ –∏–∑ –æ—á–µ—Ä–µ–¥–∏
14. –û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Å–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π

## 5. –ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏–µ–º–∫–∏

- [ ] –ö–Ω–æ–ø–∫–∞ "üì• –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ —Å—Ç–∞—Ä—ã–µ –ø–æ—Å—Ç—ã" –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
- [ ] –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —Å–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–≤—è–∑–µ–π
- [ ] –ü–µ—Ä–µ–Ω–æ—Å –∏–¥–µ—Ç –æ—Ç —Å—Ç–∞—Ä—ã—Ö –ø–æ—Å—Ç–æ–≤ –∫ –Ω–æ–≤—ã–º
- [ ] –ü–æ—Å—Ç—ã –Ω–µ –¥—É–±–ª–∏—Ä—É—é—Ç—Å—è (–ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ `message_log`)
- [ ] –ú–µ–¥–∏–∞—Ñ–∞–π–ª—ã –Ω–µ –¥—É–±–ª–∏—Ä—É—é—Ç—Å—è (–ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª—è –º–µ–¥–∏–∞-–≥—Ä—É–ø–ø)
- [ ] –ù–µ—É–¥–∞—á–Ω—ã–µ –ø–æ—Å—Ç—ã –ø—Ä–æ–ø—É—Å–∫–∞—é—Ç—Å—è, –ø–µ—Ä–µ–Ω–æ—Å –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è
- [ ] –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –æ–∫–æ–Ω—á–∞–Ω–∏–∏ –ø–µ—Ä–µ–Ω–æ—Å–∞
- [ ] –ù–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–µ–¥–∏–∞—Ñ–∞–π–ª–æ–≤ –≤ –ø–æ—Å—Ç–µ
- [ ] –ù–æ–≤—ã–µ –ø–æ—Å—Ç—ã —Å—Ç–∞–≤—è—Ç—Å—è –≤ –æ—á–µ—Ä–µ–¥—å –≤–æ –≤—Ä–µ–º—è –ø–µ—Ä–µ–Ω–æ—Å–∞
- [ ] –ü–æ—Å–ª–µ –ø–µ—Ä–µ–Ω–æ—Å–∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –ø–æ—Å—Ç—ã –∏–∑ –æ—á–µ—Ä–µ–¥–∏
- [ ] –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø—É—Å—Ç—ã—Ö –∫–∞–Ω–∞–ª–æ–≤
- [ ] –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–∞–Ω–∞–ª–æ–≤, –≥–¥–µ –≤—Å–µ –ø–æ—Å—Ç—ã —É–∂–µ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω—ã
- [ ] –°–æ–±–ª—é–¥–µ–Ω–∏–µ rate limits API
- [ ] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —ç—Ç–∞–ø–æ–≤ –ø–µ—Ä–µ–Ω–æ—Å–∞
- [ ] **–û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø**: –ë–∞—Ç—á–∏–Ω–≥ –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è (–æ–¥–∏–Ω –∑–∞–ø—Ä–æ—Å –≤–º–µ—Å—Ç–æ —Ç—ã—Å—è—á)
- [ ] **–û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø**: –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —É–∂–µ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–Ω—ã—Ö –ø–æ—Å—Ç–æ–≤ –≤ –ø–∞–º—è—Ç–∏
- [ ] **–û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø**: –ë–∞—Ç—á–∏–Ω–≥ –≤—Å—Ç–∞–≤–æ–∫ –≤ message_log (–ø–æ 100 –∑–∞–ø–∏—Å–µ–π)
- [ ] **–û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø**: –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ—Å—Ç–æ–≤ (—Å semaphore)
- [ ] **–û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø**: –ü–æ—Ç–æ–∫–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ (—ç–∫–æ–Ω–æ–º–∏—è –ø–∞–º—è—Ç–∏)
- [ ] **–û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø**: –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –º–µ–¥–∏–∞—Ñ–∞–π–ª–æ–≤
- [ ] **–û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø**: –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞

## 6. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### 6.1. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç—å –ø–æ—Å—Ç—ã —Ç–æ–ª—å–∫–æ –¥–ª—è —Å–≤–æ–∏—Ö —Å–≤—è–∑–µ–π
- –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π –±–µ–∑ —É—Ç–µ—á–∫–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏

### 6.2. –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å
- –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–µ—Ç–µ–≤—ã—Ö –æ—à–∏–±–æ–∫
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ API
- Graceful degradation –ø—Ä–∏ —á–∞—Å—Ç–∏—á–Ω—ã—Ö —Å–±–æ—è—Ö

### 6.3. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- **–ö–†–ò–¢–ò–ß–ù–û**: –ë–∞—Ç—á–∏–Ω–≥ –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è (–æ–¥–∏–Ω –∑–∞–ø—Ä–æ—Å –≤–º–µ—Å—Ç–æ —Ç—ã—Å—è—á)
- **–ö–†–ò–¢–ò–ß–ù–û**: –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –ø–∞–º—è—Ç–∏ (O(1) –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤–º–µ—Å—Ç–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –ë–î)
- **–ö–†–ò–¢–ò–ß–ù–û**: –ë–∞—Ç—á–∏–Ω–≥ –≤—Å—Ç–∞–≤–æ–∫ –≤ –ë–î (–ø–æ 100 –∑–∞–ø–∏—Å–µ–π)
- **–ö–†–ò–¢–ò–ß–ù–û**: –ò–Ω–¥–µ–∫—Å—ã –ë–î –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è
- **–í–ê–ñ–ù–û**: –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ—Å—Ç–æ–≤ (—Å semaphore –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è)
- **–í–ê–ñ–ù–û**: –ü–æ—Ç–æ–∫–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ (—ç–∫–æ–Ω–æ–º–∏—è –ø–∞–º—è—Ç–∏)
- **–í–ê–ñ–ù–û**: –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –º–µ–¥–∏–∞—Ñ–∞–π–ª–æ–≤
- **–í–ê–ñ–ù–û**: Eager loading –¥–ª—è —Å–≤—è–∑–µ–π (–∏–∑–±–µ–≥–∞—Ç—å N+1 –∑–∞–ø—Ä–æ—Å–æ–≤)

## 7. –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∫—Ä–æ—Å—Å–ø–æ—Å—Ç–∏–Ω–≥–∞
- –ü—Ä–∏ –º–∏–≥—Ä–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω—ã–π Pyrogram –∫–ª–∏–µ–Ω—Ç
- –í—Å–µ –º–µ–¥–∏–∞—Ñ–∞–π–ª—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
- –ü–µ—Ä–µ–Ω–æ—Å –º–æ–∂–µ—Ç –∑–∞–Ω–∏–º–∞—Ç—å –¥–ª–∏—Ç–µ–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –¥–ª—è –±–æ–ª—å—à–∏—Ö –∫–∞–Ω–∞–ª–æ–≤ - —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ
- **–í–ê–ñ–ù–û**: –í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ (–±–∞—Ç—á–∏–Ω–≥, –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ, –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º) –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã
- –ë–µ–∑ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π –º–∏–≥—Ä–∞—Ü–∏—è –±–æ–ª—å—à–∏—Ö –∫–∞–Ω–∞–ª–æ–≤ –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –Ω–µ–¥–æ–ø—É—Å—Ç–∏–º–æ –¥–æ–ª–≥–æ–µ –≤—Ä–µ–º—è
- –° –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è–º–∏ –æ–∂–∏–¥–∞–µ–º–æ–µ —É—Å–∫–æ—Ä–µ–Ω–∏–µ: 3-5x –¥–ª—è —Ç–∏–ø–∏—á–Ω—ã—Ö –∫–∞–Ω–∞–ª–æ–≤, –¥–æ 10x –¥–ª—è –±–æ–ª—å—à–∏—Ö

## 8. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ `config/settings.py`:

```python
# –ú–∏–≥—Ä–∞—Ü–∏—è –ø–æ—Å—Ç–æ–≤
migration_parallel_posts: int = 5  # –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å 5 –ø–æ—Å—Ç–æ–≤
migration_batch_check_size: int = 1000  # –†–∞–∑–º–µ—Ä –±–∞—Ç—á–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –±–∞—Ç—á–∏–Ω–≥)
migration_batch_log_size: int = 100  # –†–∞–∑–º–µ—Ä –±–∞—Ç—á–∞ –¥–ª—è –≤—Å—Ç–∞–≤–æ–∫ –≤ message_log
migration_progress_update_interval: int = 100  # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∫–∞–∂–¥—ã–µ 100 –ø–æ—Å—Ç–æ–≤
migration_progress_update_time: int = 300  # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç (—Å–µ–∫—É–Ω–¥—ã)
migration_streaming_enabled: bool = True  # –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ—Ç–æ–∫–æ–≤—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –∏—Å—Ç–æ—Ä–∏–∏
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏—è –∫ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º:**
- `migration_parallel_posts`: –£–≤–µ–ª–∏—á–∏–≤–∞—Ç—å —Å –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç—å—é, —É—á–∏—Ç—ã–≤–∞—è rate limits API
- `migration_batch_log_size`: –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –¥–ª—è –±–∞–ª–∞–Ω—Å–∞ –º–µ–∂–¥—É –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é –∏ –ø–∞–º—è—Ç—å—é
- `migration_progress_update_interval`: –ë–∞–ª–∞–Ω—Å –º–µ–∂–¥—É –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–æ—Å—Ç—å—é –∏ –Ω–∞–≥—Ä—É–∑–∫–æ–π –Ω–∞ –±–æ—Ç–∞

